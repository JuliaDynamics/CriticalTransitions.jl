<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Define your system · CriticalTransitions.jl</title><meta name="title" content="Define your system · CriticalTransitions.jl"/><meta property="og:title" content="Define your system · CriticalTransitions.jl"/><meta property="twitter:title" content="Define your system · CriticalTransitions.jl"/><meta name="description" content="Documentation for CriticalTransitions.jl."/><meta property="og:description" content="Documentation for CriticalTransitions.jl."/><meta property="twitter:description" content="Documentation for CriticalTransitions.jl."/><meta property="og:url" content="https://juliadynamics.github.io/CriticalTransitions.jl/man/system_construction/"/><meta property="twitter:url" content="https://juliadynamics.github.io/CriticalTransitions.jl/man/system_construction/"/><link rel="canonical" href="https://juliadynamics.github.io/CriticalTransitions.jl/man/system_construction/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.jpg" alt="CriticalTransitions.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CriticalTransitions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quickstart/">Getting started</a></li><li><a class="tocitem" href="../../examples/tutorial/">Tutorial</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/stochastic-dynamics/">Defining stochastic systems</a></li><li><a class="tocitem" href="../../examples/gMAM_Maierstein/">Large deviations: Maier-Stein system</a></li><li><a class="tocitem" href="../../examples/sgMAM_KPO/">Simple gMAM: Kerr Parametric Oscillator</a></li><li><a class="tocitem" href="../../examples/transition_path_theory_double_well/">Transition Path Theory: Finite element method</a></li><li><a class="tocitem" href="../../examples/OC_mam/">Minimal action method: Optimal Control problem</a></li><li><a class="tocitem" href="../../examples/RateSystem/">Constructing rate system</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Define your system</a><ul class="internal"><li><a class="tocitem" href="#Deterministic:-CoupledODEs"><span>Deterministic: <code>CoupledODEs</code></span></a></li><li><a class="tocitem" href="#Stochastic:-CoupledSDEs"><span>Stochastic: <code>CoupledSDEs</code></span></a></li><li><a class="tocitem" href="#Non-autonomous:-RateSystem"><span>Non-autonomous: <code>RateSystem</code></span></a></li><li><a class="tocitem" href="#Converting-between-systems"><span>Converting between systems</span></a></li></ul></li><li><a class="tocitem" href="../systemanalysis/">Stability analysis</a></li><li><a class="tocitem" href="../simulation/">Simulating the system</a></li><li><a class="tocitem" href="../sampling/">Sampling transitions</a></li><li><a class="tocitem" href="../largedeviations/">Large deviation theory</a></li><li><a class="tocitem" href="../r-tipping/">Rate-induced transitions</a></li><li><a class="tocitem" href="../transition_path_theory/">Transition path theory</a></li><li><a class="tocitem" href="../utils/">Utilities</a></li><li><a class="tocitem" href="../bibliography/">Bibliography</a></li></ul></li><li><a class="tocitem" href="../../refs/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Define your system</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Define your system</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/CriticalTransitions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/main/docs/src/man/system_construction.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Defining-a-forced-dynamical-system"><a class="docs-heading-anchor" href="#Defining-a-forced-dynamical-system">Defining a forced dynamical system</a><a id="Defining-a-forced-dynamical-system-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-a-forced-dynamical-system" title="Permalink"></a></h1><p>This section explains how to specify your dynamical system and forcing of interest.</p><p>To specify a system, <code>CriticalTransitions</code> provides three core system types:</p><ul><li><a href="#DynamicalSystemsBase.CoupledODEs">CoupledODEs</a> - used to define a deterministic system of ordinary differential equations  of the form <span>$\frac{\text{d}\mathbf{u}}{\text{d}t} = \mathbf{f}(\mathbf{u}, p, t)$</span>.</li><li><a href="#DynamicalSystemsBase.CoupledSDEs">CoupledSDEs</a> - used to define a system of stochastic differential equations of the form <span>$\text{d}\mathbf{u} = \mathbf{f}(\mathbf{u}, p, t) \text{d}t + \mathbf{g}(\mathbf{u}, p, t) \text{d}\mathcal{N}_t$</span>.</li><li><a href="#CriticalTransitions.RateSystem">RateSystem</a> - used to define a non-autonomous system with parametric forcing of the form <span>$\frac{\text{d}\mathbf{u}}{\text{d}t} = \mathbf{f}(\mathbf{u}(t), p(t))$</span>.</li></ul><p>The <code>CoupledODEs</code> and <code>CoupledSDEs</code> system types are inherited from <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/dynamicalsystemsbase/stable/"><code>DynamicalSystemsBase.jl</code></a>. The <code>RateSystem</code> type is added in CriticalTransitions.jl to enable easy construction of non-autonomous dynamical systems in which a parameter changes over time.</p><h2 id="Deterministic:-CoupledODEs"><a class="docs-heading-anchor" href="#Deterministic:-CoupledODEs">Deterministic: <code>CoupledODEs</code></a><a id="Deterministic:-CoupledODEs-1"></a><a class="docs-heading-anchor-permalink" href="#Deterministic:-CoupledODEs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.CoupledODEs" href="#DynamicalSystemsBase.CoupledODEs"><code>DynamicalSystemsBase.CoupledODEs</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CoupledODEs &lt;: ContinuousTimeDynamicalSystem
CoupledODEs(f, u0 [, p]; diffeq, t0 = 0.0)</code></pre><p>A deterministic continuous time dynamical system defined by a set of coupled ordinary differential equations as follows:</p><p class="math-container">\[\frac{d\vec{u}}{dt} = \vec{f}(\vec{u}, p, t)\]</p><p>An alias for <code>CoupledODE</code> is <code>ContinuousDynamicalSystem</code>.</p><p>Optionally provide the parameter container <code>p</code> and initial time as keyword <code>t0</code>.</p><p>For construction instructions regarding <code>f, u0</code> see the DynamicalSystems.jl tutorial.</p><p><strong>DifferentialEquations.jl interfacing</strong></p><p>The ODEs are evolved via the solvers of DifferentialEquations.jl. When initializing a <code>CoupledODEs</code>, you can specify the solver that will integrate <code>f</code> in time, along with any other integration options, using the <code>diffeq</code> keyword. For example you could use <code>diffeq = (abstol = 1e-9, reltol = 1e-9)</code>. If you want to specify a solver, do so by using the keyword <code>alg</code>, e.g.: <code>diffeq = (alg = Tsit5(), reltol = 1e-6)</code>. This requires you to have been first <code>using OrdinaryDiffEq</code> (or smaller library package such as <code>OrdinaryDiffEqVerner</code>) to access the solvers. The default <code>diffeq</code> is:</p><p>(alg = OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial<em>limiter!), typeof(OrdinaryDiffEqCore.trivial</em>limiter!), Static.False}(OrdinaryDiffEqCore.trivial<em>limiter!, OrdinaryDiffEqCore.trivial</em>limiter!, static(false)), abstol = 1.0e-6, reltol = 1.0e-6)</p><p><code>diffeq</code> keywords can also include <code>callback</code> for <a href="http://docs.juliadiffeq.org/latest/features/callback_functions.html">event handling </a>.</p><p>The convenience constructors <code>CoupledODEs(prob::ODEProblem [, diffeq])</code> and <code>CoupledODEs(ds::CoupledODEs [, diffeq])</code> are also available. Use <code>ODEProblem(ds::CoupledODEs, tspan = (t0, Inf))</code> to obtain the problem.</p><p>To integrate with ModelingToolkit.jl, the dynamical system <strong>must</strong> be created via the <code>ODEProblem</code> (which itself is created via ModelingToolkit.jl), see the Tutorial for an example.</p><p>Dev note: <code>CoupledODEs</code> is a light wrapper of <code>ODEIntegrator</code> from DifferentialEquations.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.15.1/src/core_systems/continuous_time_ode.jl#L26-L66">source</a></section></article><h2 id="Stochastic:-CoupledSDEs"><a class="docs-heading-anchor" href="#Stochastic:-CoupledSDEs">Stochastic: <code>CoupledSDEs</code></a><a id="Stochastic:-CoupledSDEs-1"></a><a class="docs-heading-anchor-permalink" href="#Stochastic:-CoupledSDEs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.CoupledSDEs" href="#DynamicalSystemsBase.CoupledSDEs"><code>DynamicalSystemsBase.CoupledSDEs</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CoupledSDEs &lt;: ContinuousTimeDynamicalSystem
CoupledSDEs(f, u0 [, p]; kwargs...)</code></pre><p>A stochastic continuous time dynamical system defined by a set of coupled stochastic differential equations (SDEs) as follows:</p><p class="math-container">\[\text{d}\mathbf{u} = \mathbf{f}(\mathbf{u}, p, t) \text{d}t + \mathbf{g}(\mathbf{u}, p, t) \text{d}\mathcal{N}_t\]</p><p>where <span>$\mathbf{u}(t)$</span> is the state vector at time <span>$t$</span>, <span>$\mathbf{f}$</span> describes the deterministic dynamics, and the noise term <span>$\mathbf{g}(\mathbf{u}, p, t) \text{d}\mathcal{N}_t$</span> describes the stochastic forcing in terms of a noise function (or <em>diffusion function</em>) <span>$\mathbf{g}$</span> and a noise process <span>$\mathcal{N}_t$</span>. The parameters of the functions <span>$\mathcal{f}$</span> and <span>$\mathcal{g}$</span> are contained in the vector <span>$p$</span>.</p><p>There are multiple ways to construct a <code>CoupledSDEs</code> depending on the type of stochastic forcing.</p><p>The only required positional arguments are the deterministic dynamic rule <code>f(u, p, t)</code>, the initial state <code>u0</code>, and optinally the parameter container <code>p</code> (by default <code>p = nothing</code>). For construction instructions regarding <code>f, u0</code> see the <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/dynamicalsystems/dev/tutorial/">DynamicalSystems.jl tutorial </a>.</p><p>By default, the noise term is standard Brownian motion, i.e. additive Gaussian white noise with identity covariance matrix. To construct different noise structures, see below.</p><p><strong>Noise term</strong></p><p>The noise term can be specified via several keyword arguments. Based on these keyword arguments, the noise function <code>g</code> is constructed behind the scenes unless explicitly given.</p><ul><li>The noise strength (i.e. the magnitude of the stochastic forcing) can be scaled with <code>noise_strength</code> (defaults to <code>1.0</code>). This factor is multiplied with the whole noise term.</li><li>For non-diagonal and correlated noise, a covariance matrix can be provided via <code>covariance</code> (defaults to identity matrix of size <code>length(u0)</code>.)</li><li>For more complicated noise structures, including state- and time-dependent noise, the noise function <code>g</code> can be provided explicitly as a keyword argument (defaults to <code>nothing</code>). For construction instructions, continue reading.</li></ul><p>The function <code>g</code> interfaces to the diffusion function specified in an <a href="https://docs.sciml.ai/DiffEqDocs/stable/types/sde_types/#SciMLBase.SDEProblem"><code>SDEProblem</code></a> of DynamicalSystems.jl. <code>g</code> must follow the same syntax as <code>f</code>, i.e., <code>g(u, p, t)</code> for out-of-place (oop) and <code>g!(du, u, p, t)</code> for in-place (iip).</p><p>Unless <code>g</code> is of vector form and describes diagonal noise, a prototype type instance for the output of <code>g</code> must be specified via the keyword argument <code>noise_prototype</code>. It can be of any type <code>A</code> that has the method <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.mul!"><code>LinearAlgebra.mul!(Y, A, B) -&gt; Y</code></a> defined. Commonly, this is a matrix or sparse matrix. If this is not given, it defaults to <code>nothing</code>, which means the <code>g</code> should be interpreted as being diagonal.</p><p>The noise process can be specified via <code>noise_process</code>. It defaults to a standard Wiener process (Gaussian white noise). For details on defining noise processes, see the docs of <a href="https://docs.sciml.ai/DiffEqNoiseProcess/stable/">DiffEqNoiseProcess.jl </a>. A complete list of the pre-defined processes can be found <a href="https://docs.sciml.ai/DiffEqNoiseProcess/stable/noise_processes/">here</a>. Note that <code>DiffEqNoiseProcess.jl</code> also has an interface for defining custom noise processes.</p><p>By combining <code>g</code> and <code>noise_process</code>, you can define different types of stochastic systems. Examples of different types of stochastic systems are listed on the <a href="https://docs.sciml.ai/DiffEqDocs/stable/tutorials/sde_example/">StochasticDiffEq.jl tutorial page</a>. A quick overview of common types of stochastic systems can also be found in the <a href="../../examples/stochastic-dynamics/#defining-stochastic-dynamics">online docs for <code>CoupledSDEs</code></a>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>g</code>: noise function (default <code>nothing</code>)</li><li><code>noise_strength</code>: scaling factor for noise strength (default <code>1.0</code>)</li><li><code>covariance</code>: noise covariance matrix (default <code>nothing</code>)</li><li><code>noise_prototype</code>: prototype instance for the output of <code>g</code> (default <code>nothing</code>)</li><li><code>noise_process</code>: stochastic process as provided by <a href="https://docs.sciml.ai/DiffEqNoiseProcess/stable/">DiffEqNoiseProcess.jl</a> (default <code>nothing</code>, i.e. standard Wiener process)</li><li><code>t0</code>: initial time (default <code>0.0</code>)</li><li><code>diffeq</code>: DiffEq solver settings (see below)</li><li><code>seed</code>: random number seed (default <code>UInt64(0)</code>)</li></ul><p><strong>DifferentialEquations.jl interfacing</strong></p><p>The <code>CoupledSDEs</code> is evolved using the solvers of DifferentialEquations.jl. To specify a solver via the <code>diffeq</code> keyword argument, use the flag <code>alg</code>, which can be accessed after loading StochasticDiffEq.jl (<code>using StochasticDiffEq</code>). The default <code>diffeq</code> is:</p><pre><code class="language-julia hljs">(alg = SOSRA(), abstol = 1.0e-2, reltol = 1.0e-2)</code></pre><p><code>diffeq</code> keywords can also include a <code>callback</code> for <a href="https://docs.sciml.ai/DiffEqDocs/stable/features/callback_functions/">event handling </a>.</p><p>Dev note: <code>CoupledSDEs</code> is a light wrapper of  <code>SDEIntegrator</code> from StochasticDiffEq.jl. The integrator is available as the field <code>integ</code>, and the <code>SDEProblem</code> is <code>integ.sol.prob</code>. The convenience syntax <code>SDEProblem(ds::CoupledSDEs, tspan = (t0, Inf))</code> is available to extract the problem.</p><p><strong>Converting between <code>CoupledSDEs</code> and <code>CoupledODEs</code></strong></p><p>You can convert a <code>CoupledSDEs</code> system to <code>CoupledODEs</code> to analyze its deterministic part using the function <code>CoupledODEs(ds::CoupledSDEs; diffeq, t0)</code>. Similarly, use <code>CoupledSDEs(ds::CoupledODEs, p; kwargs...)</code> to convert a <code>CoupledODEs</code> into a <code>CoupledSDEs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.15.1/src/core_systems/continuous_time_sde.jl#L3-L106">source</a></section></article><div class="admonition is-success" id="Tip-eedbf38764effa66"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-eedbf38764effa66" title="Permalink"></a></header><div class="admonition-body"><p>Check out some examples of how to construct different types of stochastic dynamics <a href="../../examples/stochastic-dynamics/#defining-stochastic-dynamics">here</a>.</p></div></div><div class="admonition is-info" id="Info-f2c14137fe5cdb05"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-f2c14137fe5cdb05" title="Permalink"></a></header><div class="admonition-body"><p>Note that nonlinear mixings of the Noise Process <span>$\mathcal{W}$</span> fall into the class of random ordinary differential equations (RODEs) which have a separate set of solvers. See <a href="https://docs.sciml.ai/DiffEqDocs/stable/tutorials/rode_example/">this example</a> of DifferentialEquations.jl.</p></div></div><h3 id="Accessing-CoupledSDEs-properties"><a class="docs-heading-anchor" href="#Accessing-CoupledSDEs-properties">Accessing <code>CoupledSDEs</code> properties</a><a id="Accessing-CoupledSDEs-properties-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-CoupledSDEs-properties" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.solver" href="#CriticalTransitions.solver"><code>CriticalTransitions.solver</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solver(ds::ContinuousTimeDynamicalSystem) -&gt; Any
</code></pre><p>Returns the SDE solver specified in the <code>diffeq</code> settings of the <code>CoupledSDEs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/sde_utils.jl#L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.drift" href="#CriticalTransitions.drift"><code>CriticalTransitions.drift</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drift(
    sys::Union{CoupledODEs{IIP}, CoupledSDEs{IIP}},
    x;
    t
) -&gt; Any
</code></pre><p>Returns the deterministic drift <span>$f(x)$</span> of the CoupledSDEs <code>sys</code> at state <code>x</code>. For time-dependent systems, the time can be specified as a keyword argument <code>t</code> (by default <code>t=0</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/sde_utils.jl#L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.div_drift" href="#CriticalTransitions.div_drift"><code>CriticalTransitions.div_drift</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">div_drift(sys::ContinuousTimeDynamicalSystem, x) -&gt; Any
div_drift(sys::ContinuousTimeDynamicalSystem, x, t) -&gt; Any
</code></pre><p>Computes the divergence of the drift field <span>$f(x)$</span> at state <code>x</code>. For time- dependent systems, the time can be specified as a keyword argument <code>t</code> (by default <code>t=0</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/sde_utils.jl#L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticSystemsBase.covariance_matrix" href="#StochasticSystemsBase.covariance_matrix"><code>StochasticSystemsBase.covariance_matrix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">covariance_matrix(ds::CoupledSDEs)</code></pre><p>Returns the covariance matrix of the stochastic term of the <a href="#DynamicalSystemsBase.CoupledSDEs"><code>CoupledSDEs</code></a> <code>ds</code>, provided that the diffusion function <code>g</code> can be expressed as a constant invertible matrix. If this is not the case, returns <code>nothing</code>.</p><p>See also <a href="#StochasticSystemsBase.diffusion_matrix"><code>diffusion_matrix</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.15.1/ext/src/CoupledSDEs.jl#L210-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticSystemsBase.diffusion_matrix" href="#StochasticSystemsBase.diffusion_matrix"><code>StochasticSystemsBase.diffusion_matrix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diffusion_matrix(ds::CoupledSDEs)</code></pre><p>Returns the diffusion matrix of the stochastic term of the <a href="#DynamicalSystemsBase.CoupledSDEs"><code>CoupledSDEs</code></a> <code>ds</code>, provided that the diffusion function <code>g</code> can be expressed as a constant invertible matrix. If this is not the case, returns <code>nothing</code>.</p><p>Note: The diffusion matrix <span>$Σ$</span> is the square root of the noise covariance matrix <span>$Q$</span> (see <a href="#StochasticSystemsBase.covariance_matrix"><code>covariance_matrix</code></a>), defined via the Cholesky decomposition <span>$Q = Σ Σ^\top$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.15.1/ext/src/CoupledSDEs.jl#L185-L194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.noise_process" href="#CriticalTransitions.noise_process"><code>CriticalTransitions.noise_process</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">noise_process(sys::CoupledSDEs) -&gt; Any
</code></pre><p>Fetches the stochastic process <span>$\mathcal{N}$</span> specified in the intergrator of <code>sys</code>. Returns the type <code>DiffEqNoiseProcess.NoiseProcess</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/sde_utils.jl#L13">source</a></section></article><h2 id="Non-autonomous:-RateSystem"><a class="docs-heading-anchor" href="#Non-autonomous:-RateSystem">Non-autonomous: <code>RateSystem</code></a><a id="Non-autonomous:-RateSystem-1"></a><a class="docs-heading-anchor-permalink" href="#Non-autonomous:-RateSystem" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.RateSystem" href="#CriticalTransitions.RateSystem"><code>CriticalTransitions.RateSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RateSystem &lt;: ContinuousTimeDynamicalSystem
RateSystem(ds::ContinuousTimeDynamicalSystem, fp::ForcingProfile, pidx; kwargs...)</code></pre><p>A non-autonomous dynamical system constructed by applying a time-dependent parametric forcing protocol (<a href="#CriticalTransitions.ForcingProfile"><code>ForcingProfile</code></a>) to an underlying autonomous continuous-time dynamical system <code>ds</code>.</p><p>The <code>ForcingProfile</code>, applied to the parameter with index <code>pidx</code>, describes the functional form of the parameter evolution over a given <code>interval</code>. This interval is rescaled in system time units by defining its start time (<code>forcing_start_time</code>) and duration (<code>forcing_duration</code>). The magnitude of the forcing can be adjusted by scaling the forcing profile by a factor <code>forcing_scale</code>.</p><p>The integer <code>pidx</code> refers to the relevant index of the parameter container <code>p</code> of <code>ds</code>.</p><p>Before <code>t = forcing_start_time</code>, the system parameters correspond to that of the underlying autonomous system <code>ds</code>. At the end of the forcing interval (<code>t = forcing_start_time + forcing_duration</code>), the parameters are frozen at their current value and thereafter the system is again autonomous.</p><p><strong>Keyword arguments</strong></p><ul><li><code>forcing_start_time = fp.interval[1]</code>: Time when parameter change starts</li><li><code>forcing_duration = fp.interval[2] - fp.interval[1]</code>: Duration of the parameter change (in system time units)</li><li><code>forcing_scale = 1.0</code>: Amplitude multiplication factor of the forcing protocol</li><li><code>t0 = 0.0</code>: Initial time of the system</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/r_tipping/RateSystem.jl#L38-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.ForcingProfile" href="#CriticalTransitions.ForcingProfile"><code>CriticalTransitions.ForcingProfile</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForcingProfile(profile::Function, interval)</code></pre><p>Time-dependent forcing profile <span>$p(t)$</span> describing the evolution of a parameter over a domain interval <code>interval = (start, end)</code>. Used to define a parametric forcing when  constructing a non-autonomous <a href="#CriticalTransitions.RateSystem"><code>RateSystem</code></a>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>profile</code>: function <span>$p(t)$</span> from <span>$ℝ → ℝ$</span> describing the parameter change</li><li><code>interval</code>: domain interval over which the <code>profile</code> is considered</li></ul><p>Note: The units of <code>t</code> are arbitrary; the forcing profile is rescaled in system time units and magnitude when using it to construct a <code>RateSystem</code>.</p><p><strong>Convenience functions</strong></p><ul><li><code>ForcingProfile(:linear)</code>: Creates a linear ramp from 0 to 1.</li><li><code>ForcingProfile(:tanh)</code>: Creates a hyperbolic tangent ramping from 0 to 1.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/r_tipping/ForcingProfile.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.frozen_system" href="#CriticalTransitions.frozen_system"><code>CriticalTransitions.frozen_system</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">frozen_system(rs::RateSystem, t)
</code></pre><p>Returns an autonomous dynamical system of type <a href="#DynamicalSystemsBase.CoupledODEs"><code>DynamicalSystemsBase.CoupledODEs</code></a>  corresponding to the frozen system of the non-autonomous <a href="#CriticalTransitions.RateSystem"><code>RateSystem</code></a> <code>rs</code> at time <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/r_tipping/RateSystem.jl#L187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.parameters" href="#CriticalTransitions.parameters"><code>CriticalTransitions.parameters</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parameters(rs::RateSystem, t) -&gt; Any
</code></pre><p>Returns the parameter vector of a <a href="#CriticalTransitions.RateSystem"><code>RateSystem</code></a> at time <code>t</code> (in system time units).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/r_tipping/RateSystem.jl#L175">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.set_forcing_start!" href="#CriticalTransitions.set_forcing_start!"><code>CriticalTransitions.set_forcing_start!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_forcing_start!(rs::RateSystem, start_time)
</code></pre><p>Sets the start time (<code>forcing_start_time</code>) of the forcing protocol applied to the <a href="#CriticalTransitions.RateSystem"><code>RateSystem</code></a> <code>rs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/r_tipping/RateSystem.jl#L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.set_forcing_duration!" href="#CriticalTransitions.set_forcing_duration!"><code>CriticalTransitions.set_forcing_duration!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_forcing_duration!(
    rs::RateSystem,
    duration
) -&gt; RateSystem
</code></pre><p>Sets the duration (<code>forcing_duration</code>) of the forcing protocol applied to the <a href="#CriticalTransitions.RateSystem"><code>RateSystem</code></a> <code>rs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/r_tipping/RateSystem.jl#L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CriticalTransitions.set_forcing_scale!" href="#CriticalTransitions.set_forcing_scale!"><code>CriticalTransitions.set_forcing_scale!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_forcing_scale!(rs::RateSystem, scale) -&gt; RateSystem
</code></pre><p>Sets the amplitude (<code>forcing_scale</code>) of the forcing protocol applied to the <a href="#CriticalTransitions.RateSystem"><code>RateSystem</code></a> <code>rs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/34124021ad11164390c9e3556bf6c4bce14a747a/src/r_tipping/RateSystem.jl#L142">source</a></section></article><h2 id="Converting-between-systems"><a class="docs-heading-anchor" href="#Converting-between-systems">Converting between systems</a><a id="Converting-between-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Converting-between-systems" title="Permalink"></a></h2><p>The deterministic part of a <a href="#DynamicalSystemsBase.CoupledSDEs"><code>CoupledSDEs</code></a> can be extracted as a  <a href="#DynamicalSystemsBase.CoupledODEs"><code>CoupledODEs</code></a>, making it compatible with functionality of <code>DynamicalSystems.jl</code>. In turn, a <code>CoupledODEs</code> can easily be extended into a <code>CoupledSDEs</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.CoupledODEs-Tuple{CoupledSDEs}" href="#DynamicalSystemsBase.CoupledODEs-Tuple{CoupledSDEs}"><code>DynamicalSystemsBase.CoupledODEs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CoupledODEs(ds::CoupledSDEs; kwargs...)</code></pre><p>Converts a <a href="#DynamicalSystemsBase.CoupledSDEs"><code>CoupledSDEs</code></a> into a <a href="#DynamicalSystemsBase.CoupledODEs"><code>CoupledODEs</code></a> by extracting the deterministic part of <code>ds</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.15.1/ext/src/CoupledSDEs.jl#L130-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.CoupledSDEs-Tuple{CoupledODEs, Any}" href="#DynamicalSystemsBase.CoupledSDEs-Tuple{CoupledODEs, Any}"><code>DynamicalSystemsBase.CoupledSDEs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CoupledSDEs(ds::CoupledODEs, p; kwargs...)</code></pre><p>Converts a <a href="https://juliadynamics.github.io/DynamicalSystems.jl/stable/tutorial/#CoupledODEs"><code>CoupledODEs</code> </a> system into a <a href="#DynamicalSystemsBase.CoupledSDEs"><code>CoupledSDEs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.15.1/ext/src/CoupledSDEs.jl#L105-L111">source</a></section></article><p>For example, the Lyapunov spectrum of a <code>CoupledSDEs</code> in the absence of noise, here exemplified by the FitzHugh-Nagumo model, can be computed by typing:</p><pre><code class="language-julia hljs">using CriticalTransitions
using ChaosTools: lyapunovspectrum

function fitzhugh_nagumo(u, p, t)
    x, y = u
    ϵ, β = p
    dx = (-x^3 + x - y)/ϵ
    dy = -β*y + x
    return SVector{2}([dx, dy])
end

p = [1.,3.]

# Define the CoupledSDEs
sys = CoupledSDEs(fitzhugh_nagumo, ones(2), p; noise_strength=0.1)

# Compute Lyapunov spectrum of deterministic flow
ls = lyapunovspectrum(CoupledODEs(sys), 10000)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
  0.0037846226653203657
 -0.028280268988271094</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../examples/RateSystem/">« Constructing rate system</a><a class="docs-footer-nextpage" href="../systemanalysis/">Stability analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Monday 3 November 2025 21:27">Monday 3 November 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
