<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simple gMAM: Kerr Parametric Oscillator · CriticalTransitions.jl</title><meta name="title" content="Simple gMAM: Kerr Parametric Oscillator · CriticalTransitions.jl"/><meta property="og:title" content="Simple gMAM: Kerr Parametric Oscillator · CriticalTransitions.jl"/><meta property="twitter:title" content="Simple gMAM: Kerr Parametric Oscillator · CriticalTransitions.jl"/><meta name="description" content="Documentation for CriticalTransitions.jl."/><meta property="og:description" content="Documentation for CriticalTransitions.jl."/><meta property="twitter:description" content="Documentation for CriticalTransitions.jl."/><meta property="og:url" content="https://juliadynamics.github.io/CriticalTransitions.jl/examples/sgMAM_KPO/"/><meta property="twitter:url" content="https://juliadynamics.github.io/CriticalTransitions.jl/examples/sgMAM_KPO/"/><link rel="canonical" href="https://juliadynamics.github.io/CriticalTransitions.jl/examples/sgMAM_KPO/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.jpg" alt="CriticalTransitions.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CriticalTransitions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quickstart/">Getting started</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Defining a system</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../stochastic-dynamics/">Stochastic system</a></li><li><a class="tocitem" href="../RateSystem/">Nonautonomous system</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">System analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../gMAM_Maierstein/">Large deviations: Maier-Stein system</a></li><li class="is-active"><a class="tocitem" href>Simple gMAM: Kerr Parametric Oscillator</a></li><li><a class="tocitem" href="../OC_mam/">Minimal action method: Optimal Control problem</a></li><li><a class="tocitem" href="../transition_path_theory_double_well/">Transition path theory: Finite element method</a></li></ul></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../man/system_construction/">Define your system</a></li><li><a class="tocitem" href="../../man/systemanalysis/">Stability analysis</a></li><li><a class="tocitem" href="../../man/simulation/">Simulating the system</a></li><li><a class="tocitem" href="../../man/sampling/">Sampling transitions</a></li><li><a class="tocitem" href="../../man/largedeviations/">Large deviation theory</a></li><li><a class="tocitem" href="../../man/r-tipping/">Rate-induced transitions</a></li><li><a class="tocitem" href="../../man/transition_path_theory/">Transition path theory</a></li><li><a class="tocitem" href="../../man/utils/">Utilities</a></li><li><a class="tocitem" href="../../man/bibliography/">Bibliography</a></li></ul></li><li><a class="tocitem" href="../../refs/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">System analysis</a></li><li class="is-active"><a href>Simple gMAM: Kerr Parametric Oscillator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simple gMAM: Kerr Parametric Oscillator</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/CriticalTransitions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/CriticalTransitions.jl/blob/main/examples/sgMAM_KPO.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>We demonstrate the simple geometric minimum action method (sgMAM) on the Kerr parametric oscillator (KPO). The method computes the optimal path between two attractors in the phase space that minimizes the action of the system. It is a simplification of the geometric minimum action method (gMAM) by avoiding the computation of the second order derivatives of the extended Hamiltonian of the optimisation problem.</p><pre><code class="language-julia hljs">using CriticalTransitions, CairoMakie</code></pre><p>The KPO equation is a nonlinear ordinary differential equation that describes the response of the nonlinear parametrically driven resonator at its dominant resonant condition. The equation of motion are of the form:</p><p class="math-container">\[\dot{\mathbf{x}} = \mathbf{f}(\mathbf{x}) + \sigma\mathbf{ξ}(t)\]</p><p>where <code>f</code> is an autonemous drift function and and we have brownian noise <code>ξ</code> with intensity <code>σ</code>.</p><p>Here we define the define the drift of each separable variable <code>u</code> and <code>v</code>. In addition, we hard-code the Jacobian of the drift function.</p><pre><code class="language-julia hljs">const λ = 3 / 1.21 * 2 / 295
const ω0 = 1.000
const ω = 1.000
const γ = 1 / 295
const η = 0
const α = -1

function fu(u, v)
    return (-4 * γ * ω * u - 2 * λ * v - 4 * (ω0 - ω^2) * v - 3 * α * v * (u^2 + v^2)) /
           (8 * ω)
end
function fv(u, v)
    return (-4 * γ * ω * v - 2 * λ * u + 4 * (ω0 - ω^2) * u + 3 * α * u * (u^2 + v^2)) /
           (8 * ω)
end
stream(u, v) = Point2f(fu(u, v), fv(u, v))
dfvdv(u, v) = (-4 * γ * ω + 6 * α * u * v) / (8 * ω)
dfudu(u, v) = (-4 * γ * ω - 6 * α * u * v) / (8 * ω)
dfvdu(u, v) = (-2 * λ + 4 * (ω0 - ω^2) + 9 * α * u^2 + 3 * α * v^2) / (8 * ω)
dfudv(u, v) = (-2 * λ - 4 * (ω0 - ω^2) - 3 * α * u^2 - 9 * α * v^2) / (8 * ω)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">dfudv (generic function with 1 method)</code></pre><p>The optimisation is performed in a doubled phase space, i.e., every variable of the SDE system is considered as a generelised coordinate <span>$\mathbf{x}$</span> and gets a corresponding generalised momentum <span>$\mathbf{p}$</span>. The makes it that also systems with dissipative flow can be solved. As such, we extend the phase space by defining the hamiltionian</p><p class="math-container">\[H = \sum_i \frac{p_i^2}{2} + f_i(\mathbf{x})p_i\]</p><p>Hence, to use the sgMAM method, we need to define the derivatives of the Hamiltonian with respect to the phase space coordinates and the generalised momentum:</p><pre><code class="language-julia hljs">function H_x(x, p) # ℜ² → ℜ²
    u, v = eachrow(x)
    pu, pv = eachrow(p)

    H_u = @. pu * dfudu(u, v) + pv * dfvdu(u, v)
    H_v = @. pu * dfudv(u, v) + pv * dfvdv(u, v)
    return Matrix([H_u H_v]&#39;)
end
function H_p(x, p) # ℜ² → ℜ²
    u, v = eachrow(x)
    pu, pv = eachrow(p)

    H_pu = @. pu + fu(u, v)
    H_pv = @. pv + fv(u, v)
    return Matrix([H_pu H_pv]&#39;)
end

sys = ExtendedPhaseSpace{false,2}(H_x, H_p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Doubled 2-dimensional phase space containing out-of-place functions</code></pre><p>We saved this function in the <code>ExtendedPhaseSpace</code> struct. We want to find the optimal path between two attractors in the phase space. We define the initial trajectory as <code>wiggle</code> between the two attractors.</p><pre><code class="language-julia hljs">Nt = 500  # number of discrete time steps
s = collect(range(0; stop=1, length=Nt))

xa = [-0.0208, 0.0991]
xb = -xa
xsaddle = [0.0, 0.0]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.0
 0.0</code></pre><p>Initial trajectory</p><pre><code class="language-julia hljs">xx = @. (xb[1] - xa[1]) * s + xa[1] + 4 * s * (1 - s) * xsaddle[1]
yy = @. (xb[2] - xa[2]) * s + xa[2] + 4 * s * (1 - s) * xsaddle[2] + 0.01 * sin(2π * s)
x_initial = Matrix([xx yy]&#39;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×500 Matrix{Float64}:
 -0.0208  -0.0207166  -0.0206333  …   0.0206333   0.0207166   0.0208
  0.0991   0.0988287   0.0985574     -0.0985574  -0.0988287  -0.0991</code></pre><p>The optimisation is the performed by the <code>simple_geometric_min_action_method</code> function:</p><pre><code class="language-julia hljs">MLP = simple_geometric_min_action_method(
    sys, x_initial; iterations=1_000, ϵ=10e2, show_progress=false
)
x_min = MLP.path;</code></pre><p>The function returns the optimal path <code>x_min</code>, the minimal action <code>S_min</code>, the Lagrange multipliers <code>lambda</code> associated with the optimal path, the optimal generalised momentum <code>p</code>, and the time derivative of the optimal path <code>xdot</code>. We can plot the initial trajectory and the optimal path:</p><pre><code class="language-julia hljs">fig, ax, _ = lines(
    x_initial[1, :], x_initial[2, :]; label=&quot;init&quot;, linewidth=3, color=:black
)
lines!(x_min[:, 1], x_min[:, 2]; label=&quot;MLP&quot;, linewidth=3, color=:red)
streamplot!(
    ax,
    stream,
    (-0.08, 0.08),
    (-0.15, 0.15);
    gridsize=(20, 20),
    arrow_size=10,
    stepsize=0.001,
    colormap=[:gray, :gray],
)
axislegend(ax)
fig</code></pre><img src="c3eebbdf.png" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gMAM_Maierstein/">« Large deviations: Maier-Stein system</a><a class="docs-footer-nextpage" href="../OC_mam/">Minimal action method: Optimal Control problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 21 January 2026 21:31">Wednesday 21 January 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
